<?xml version="1.0" encoding="utf-8"?>
<openerp>
   <data>
        <!--Report template:-->
        <template id="report_account_ddt">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.internal_layout">
                        <div class="page">
                             <!-- HEADER: -->
                            <div class="row">
                                <div class="col-xs-2">
                                    <!--LOGO-->
                                    <div style="width: 100%;float: left;">
                                        <img src='/web/binary/company_logo' style="width: 100%"/>
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <span t-field="res_company.partner_id.contact_info" /><br/>
                                    P. IVA: <span t-field="res_company.partner_id.vat" />
                                </div>    
                                <div class="col-xs-6">
                                    <h1 t-field="o.partner_id.country_id.code" /><br />
                                    <img t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s'%('Code128', (o.ddt_number or o.refund_number or '').split('/')[-1], 800, 50)" style="width:400px;height:50px;" /><br/>
                                    <span t-esc="'Reso cliente nr. ' if o.refund_number else 'Doc. di trasporto nr. '" /><span t-esc="o.ddt_number or o.refund_number" /> del <span t-esc="o.ddt_date or o.refund_date" />
                                </div>    
                            </div>                            
                            <div class="oe_structure"/>
                            <hr />
                            
                             <!-- DESTINATION BOX: -->
                            <div class="oe_structure"/>                            
                            <div class="row">
                                <div class="col-xs-5">
                                    Destinatario
                                </div>    
                                <div class="col-xs-1">
                                </div>                                
                                <div class="col-xs-6">
                                    Destinazione
                                </div>    
                            </div>    
                            <div class="oe_structure"/>
                            <div class="row">
                                <div class="col-xs-5" style="height: 150px; border: 1px solid black;">
                                    <div t-field="o.sale_order_id.partner_id.contact_info" />
                                </div>    
                                <div class="col-xs-1">
                                </div>                                
                                <div class="col-xs-6" style="height: 150px; border: 1px solid black;">
                                    <div t-field="(o.sale_order_id.partner_shipping_id or o.sale_order_id.partner_id).contact_info" />
                                </div>    
                            </div>    
                            <div class="oe_structure"/>
                            
                            <!-- DETAIL: -->
                            <br />
                            <div class="oe_structure"/>                            
                            <div class="row">
                                <div class="col-xs-2">
                                </div>
                                <div class="col-xs-1">
                                    <b>Q.ta'</b>
                                </div>    
                                <div class="col-xs-4">
                                    <b>Cod. Art.</b>
                                </div>    
                                <div class="col-xs-5">
                                    <b>Descrizione</b>
                                </div>    
                            </div>
                            
                            <!--Order reference:-->    
                            <!--<div class="row">
                                <div class="col-xs-6">
                                </div>    
                                <div class="col-xs-6">
                                    <b>Rif. Conferma d'ordine: <span t-field="o.sale_order_id.name" /></b>
                                </div>    
                            </div>-->
                            <div class="oe_structure"/>

                            <t t-foreach="o.move_lines_for_report()" t-as="move">
                                <!--Order header-->
                                <div t-if="move[14]" class="row">
                                    <div class="col-xs-1">
                                    </div>    
                                    <div class="col-xs-11">
                                        <b>Rif. Conferma d'ordine: <span t-esc="move[14]" /></b>
                                    </div> 
                                </div>
                                
                                <div class="row">
                                    <div class="col-xs-2">
                                        <img t-att-src="'data:image/png;base64,%s' % to_text(move[0].new_image)"/>
                                    </div>    
                                    <div class="col-xs-1" style="align:text-center;">
                                        <h4 t-esc="move[1]" />
                                    </div>    
                                    <div class="col-xs-5" style="float: left; align:text-left;">
                                        <span t-esc="move[0].product_tmpl_id.default_code or &quot; &quot;" /><br/>
                                        <i><span t-if="move[2]" t-field="move[2].product_tmpl_id.default_code" /></i>
                                        <img t-if="move[0].product_tmpl_id.default_code" t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s'%('Code128', move[0].product_tmpl_id.default_code, 800, 50)" style="width:400px;height:25px;"/><br/>
                                    </div>    
                                    <div class="col-xs-6">
                                        <h4 t-field="move[0].name" />
                                    </div>    
                                </div> 
                            </t>
                            
                            <!-- END OF PAGE: -->
                            <br />
                            <div class="oe_structure"/>                            
                            <div class="row">
                                <div class="col-xs-6" style="height: 60px; border: 1px solid black;">
                                    <b>Incaricato del trasporto:</b><br/>
                                    <span t-esc="o.carrier_id.name or ''" />
                                </div>
                                <div class="col-xs-3" style="height: 60px; border: 1px solid black;">
                                    <b>Causale del trasporto:</b><br/>
                                    <span t-esc="o.carriage_condition_id.name or ''" />
                                </div>
                                <div class="col-xs-3" style="height: 60px; border: 1px solid black;">
                                    <b>Firma incaricato del trasporto:</b><br/>
                                    
                                </div>
                            </div>    
                            <div class="row">
                                <div class="col-xs-1" style="height: 60px; border: 1px solid black;">
                                    <b>Colli:</b><br/>
                                    <span t-esc="o.parcels" />
                                </div>
                                <div class="col-xs-1" style="height: 60px; border: 1px solid black;">
                                    <b>Peso:</b><br/>
                                    <span t-esc="o.weight" />
                                </div>
                                <div class="col-xs-2" style="height: 60px; border: 1px solid black;">
                                    <b>Aspetto est. beni:</b><br/>
                                    <span t-esc="o.goods_description_id.name or ''" />
                                </div>
                                <div class="col-xs-2" style="height: 60px; border: 1px solid black;">
                                    <b>Porto:</b><br/>
                                    <span t-esc="o.transportation_method_id.name or ''" />
                                </div>
                                <div class="col-xs-3" style="height: 60px; border: 1px solid black;">
                                    <b>Data e ora inizio trasporto:</b><br/>
                                    <span t-esc="o.ddt_date or ''" />
                                </div>
                                <div class="col-xs-3" style="height: 60px; border: 1px solid black;">
                                    <b>Firma destinatario:</b><br/>
                                    
                                </div>
                            </div>    

                            <!-- IMPORTANT: -->
                            <br />
                            <div class="oe_structure"/>                            
                            <div class="row">
                                <div class="col-xs-12" style="border: 1px solid black;">
                                    IMPORTANTE: Lo staff Brixia Moto ringrazia per l’acquisto e la fiducia prestata.
                                    Ogni nostra spedizione è accompagnata da regolare DDT di vendita, il quale fa fede in termini di data di
                                    acquisto e garanzia del prodotto ordinato. Questo rapporto di vendita non e' soggetto ne' all'obbligo di emissione
                                    della fattura (a meno che non sia richiesta dal cliente, non oltre il momento di effettuazione dell'operazione) come
                                    stabilito dall'art.22 DPR 633/1972. ne' a quello di certificazione tramite scontrino o ricevuta fiscale fiscale ex art.2
                                    co.1 lett. oo DPR 696/1996.
                                    Restano salve tutte le garanzie di vendita, tra cui il diritto di recesso, come illustrato nelle condizioni generali di
                                    vendita (a cui si rimanda) pubblicate sul sito.
                                </div>    
                            </div>    

                            <!-- PRIVACY: -->
                            <div class="oe_structure"/>
                            <div class="row">
                                <div class="col-xs-1">
                                    Pag. 1
                                </div>    
                                <div class="col-xs-11">
                                    Ai sensi del D.Lgs. 196/2003 Vi informiamo che i Vs. dati saranno utilizzati esclusivamente per i fini connessi ai rapporti commerciali tra di noi in essere.
                                    Vi preghiamo di controllare i Vs. dati anagrafici, la Partita IVA e il Codice Fiscale. Non ci riteniamo responsabili di eventuali errori.
                                </div>    
                            </div>    
                            <br />
                        </div>
                    </t>
                </t>
            </t>
        </template>   
        <!--
        <template id="report_saleorder_document">
            <t t-set="doc" t-value="doc.with_context({'lang':user.partner_id.lang})" />
        <template id="report_saleorder_style" inherit_id="report.style">
          <xpath expr=".">
            <t>
              .example-css-class {
                background-color: red;
              }
            </t>
          </xpath>
        </template>
        -->
        <template id="report_ddt_lang">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="logistic_account_report.report_account_ddt" t-lang="doc.partner_id.lang"/>
                </t>
            </t>
        </template>

        <record id="paperformat_accounting" model="report.paperformat">
            <field name="name">Account report</field>
            <field name="default" eval="True"/>
            <field name="format">custom</field>
            <field name="page_height">297</field>
            <field name="page_width">210</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">10</field>
            <field name="margin_bottom">5</field>
            <field name="margin_left">5</field>
            <field name="margin_right">5</field>
            <field name="header_line" eval="True"/>
            <field name="header_spacing">3</field>
            <field name="dpi">300</field>
        </record>
        
        <!--Report action:-->
        <report
            id="action_report_ddt_lang"
            model="stock.picking"
            string="Account DDT report"
            report_type="qweb-pdf"
            name="logistic_account_report.report_ddt_lang"
            file="logistic_account_report.report_ddt_lang"
            attachment_use="True"
            attachment="'%s.pdf' % (object.ddt_number or 'draft').replace('/', '_')"
            print_report_name="'%s.pdf' % (object.ddt_number or 'draft').replace('/', '_')"
            paperformat="paperformat_accounting"
        />

   </data>
</openerp>
